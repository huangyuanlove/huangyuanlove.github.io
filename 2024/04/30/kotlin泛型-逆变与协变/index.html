

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="https://avatars.githubusercontent.com/u/4216225?v=4">
  <link rel="icon" href="https://avatars.githubusercontent.com/u/4216225?v=4">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="HuangYuan_xuan">
  <meta name="keywords" content="kotlin æ³›å‹,é€†å˜,Covariant,åå˜,Variance,ä½¿ç”¨å¤„å‹å˜,å£°æ˜å¤„å‹å˜,æ˜ŸæŠ•å½±,Star-Projections">
  
    <meta name="description" content="æ³›å‹ä¸­æ¶‰åŠåˆ°çš„æ¦‚å¿µä¹Ÿä¸å°‘,å‹å˜(Variance)ã€é€†å˜(Contravariance)ã€åå˜(Covariance)ã€ä¸å˜(Invariant).åœ¨ kotlin ä¸­è¿˜æœ‰ä¸‰ä¸ªå…³é”®å­—inã€outã€whereã€reifiedç­‰,åœ¨javaä¸­åŒæ ·ä¹Ÿæœ‰? extendsã€? superã€?è¿™äº›æ¦‚å¿µæ˜¯å•¥æ„æ€å˜ï¼Ÿå¼•ç”¨ç‚¹æ¦‚å¿µè¯´æ˜  å‹å˜(Variance)ã€åå˜(Covariance)ã€é€†å˜(Contrava">
<meta property="og:type" content="article">
<meta property="og:title" content="kotlinæ³›å‹:é€†å˜ä¸åå˜">
<meta property="og:url" content="https://blog.huangyuanlove.com/2024/04/30/kotlin%E6%B3%9B%E5%9E%8B-%E9%80%86%E5%8F%98%E4%B8%8E%E5%8D%8F%E5%8F%98/index.html">
<meta property="og:site_name" content="æ”¾ç è¿‡æ¥">
<meta property="og:description" content="æ³›å‹ä¸­æ¶‰åŠåˆ°çš„æ¦‚å¿µä¹Ÿä¸å°‘,å‹å˜(Variance)ã€é€†å˜(Contravariance)ã€åå˜(Covariance)ã€ä¸å˜(Invariant).åœ¨ kotlin ä¸­è¿˜æœ‰ä¸‰ä¸ªå…³é”®å­—inã€outã€whereã€reifiedç­‰,åœ¨javaä¸­åŒæ ·ä¹Ÿæœ‰? extendsã€? superã€?è¿™äº›æ¦‚å¿µæ˜¯å•¥æ„æ€å˜ï¼Ÿå¼•ç”¨ç‚¹æ¦‚å¿µè¯´æ˜  å‹å˜(Variance)ã€åå˜(Covariance)ã€é€†å˜(Contrava">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-04-30T02:59:38.000Z">
<meta property="article:modified_time" content="2024-05-28T02:46:59.952Z">
<meta property="article:author" content="HuangYuan_xuan">
<meta property="article:tag" content="Android">
<meta property="article:tag" content="Kotlin">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>kotlinæ³›å‹:é€†å˜ä¸åå˜ - æ”¾ç è¿‡æ¥</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"blog.huangyuanlove.com","root":"/","version":"1.9.5","typing":{"enable":true,"typeSpeed":100,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":3},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":"7a06626d17ff9ce19e18d0f08e94d8ba","google":"UA-123314537-1","tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"gtag":null},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="æ”¾ç è¿‡æ¥" type="application/atom+xml">
</head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>æ”¾ç è¿‡æ¥</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>é¦–é¡µ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>å½’æ¡£</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>æ ‡ç­¾</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>å‹é“¾</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="kotlinæ³›å‹:é€†å˜ä¸åå˜"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-04-30 10:59" pubdate>
          2024å¹´4æœˆ30æ—¥ ä¸Šåˆ
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          11k å­—
        
      </span>
    

    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">kotlinæ³›å‹:é€†å˜ä¸åå˜</h1>
            
            
              <div class="markdown-body">
                
                <p>æ³›å‹ä¸­æ¶‰åŠåˆ°çš„æ¦‚å¿µä¹Ÿä¸å°‘,å‹å˜(Variance)ã€é€†å˜(Contravariance)ã€åå˜(Covariance)ã€ä¸å˜(Invariant).åœ¨ kotlin ä¸­è¿˜æœ‰ä¸‰ä¸ªå…³é”®å­—<code>in</code>ã€<code>out</code>ã€<code>where</code>ã€<code>reified</code>ç­‰,åœ¨javaä¸­åŒæ ·ä¹Ÿæœ‰<code>? extends</code>ã€<code>? super</code>ã€<code>?</code><br>è¿™äº›æ¦‚å¿µæ˜¯å•¥æ„æ€å˜ï¼Ÿå¼•ç”¨ç‚¹æ¦‚å¿µè¯´æ˜</p>
<blockquote>
<p>å‹å˜(Variance)ã€åå˜(Covariance)ã€é€†å˜(Contravariance)å’Œä¸å˜(Invariant)æ˜¯ç›¸å…³ä½†ä¸åŒçš„æ¦‚å¿µ.</p>
</blockquote>
<blockquote>
<p>å‹å˜æ˜¯æŒ‡æ³›å‹ç±»å‹å‚æ•°åœ¨å­ç±»å‹å…³ç³»ä¸­çš„è¡Œä¸º.å®ƒæè¿°äº†ä¸€ä¸ªæ³›å‹ç±»å‹æ˜¯å¦å…è®¸ç±»å‹å‚æ•°çš„å­ç±»å‹å…³ç³»ä¸æ³›å‹ç±»å‹å‚æ•°çš„å­ç±»å‹å…³ç³»ä¿æŒä¸€è‡´.åœ¨æ³›å‹ä¸­,å¯ä»¥æœ‰ä¸‰ç§å‹å˜ç±»å‹ï¼šåå˜ã€é€†å˜å’Œä¸å˜.</p>
</blockquote>
<blockquote>
<p>åå˜æ˜¯æŒ‡å¦‚æœä¸€ä¸ªæ³›å‹ç±»å‹çš„å­ç±»å‹å…³ç³»ä¸å…¶ç±»å‹å‚æ•°çš„å­ç±»å‹å…³ç³»ä¿æŒä¸€è‡´,åˆ™è¯¥æ³›å‹ç±»å‹æ˜¯åå˜çš„.ç®€è€Œè¨€ä¹‹,å¦‚æœå­ç±»å‹çš„æ³›å‹å‚æ•°æ˜¯çˆ¶ç±»å‹æ³›å‹å‚æ•°çš„å­ç±»å‹,å°±å¯ä»¥è¯´è¯¥æ³›å‹ç±»å‹æ˜¯åå˜çš„.</p>
</blockquote>
<blockquote>
<p>é€†å˜æ˜¯æŒ‡å¦‚æœä¸€ä¸ªæ³›å‹ç±»å‹çš„å­ç±»å‹å…³ç³»ä¸å…¶ç±»å‹å‚æ•°çš„å­ç±»å‹å…³ç³»ç›¸å,åˆ™è¯¥æ³›å‹ç±»å‹æ˜¯é€†å˜çš„.ç®€è€Œè¨€ä¹‹,å¦‚æœå­ç±»å‹çš„æ³›å‹å‚æ•°æ˜¯çˆ¶ç±»å‹æ³›å‹å‚æ•°çš„è¶…ç±»å‹,å°±å¯ä»¥è¯´è¯¥æ³›å‹ç±»å‹æ˜¯é€†å˜çš„.</p>
</blockquote>
<blockquote>
<p>ä¸å˜æ˜¯æŒ‡ä¸€ä¸ªæ³›å‹ç±»å‹çš„å­ç±»å‹å…³ç³»ä¸å…¶ç±»å‹å‚æ•°æ— å…³,å³ç±»å‹å‚æ•°çš„å­ç±»å‹å…³ç³»ä¸æ³›å‹ç±»å‹çš„å­ç±»å‹å…³ç³»æ— å…³.åœ¨ä¸å˜çš„æƒ…å†µä¸‹,ä¸èƒ½å°†çˆ¶ç±»å‹çš„å¯¹è±¡èµ‹å€¼ç»™å­ç±»å‹çš„å¯¹è±¡,ä¹Ÿä¸èƒ½å°†å­ç±»å‹çš„å¯¹è±¡èµ‹å€¼ç»™çˆ¶ç±»å‹çš„å¯¹è±¡.</p>
</blockquote>
<blockquote>
<p>å› æ­¤,å¯ä»¥è¯´åå˜å’Œé€†å˜æ˜¯å‹å˜çš„ä¸¤ç§å…·ä½“å½¢å¼,è€Œä¸å˜åˆ™æ˜¯å‹å˜çš„ä¸€ç§ç‰¹æ®Šæƒ…å†µ.</p>
</blockquote>
<blockquote>
<p>æ€»ç»“èµ·æ¥,åå˜ã€é€†å˜å’Œä¸å˜æè¿°äº†æ³›å‹ç±»å‹å‚æ•°ä¸æ³›å‹ç±»å‹ä¹‹é—´å­ç±»å‹å…³ç³»çš„ä¸åŒè¡Œä¸º.åå˜å’Œé€†å˜æ˜¯å¯¹å­ç±»å‹å…³ç³»çš„å…·ä½“çº¦æŸ,è€Œä¸å˜åˆ™æ˜¯æ²¡æœ‰ä»»ä½•å­ç±»å‹å…³ç³»çš„çº¦æŸ.å®ƒä»¬ä¹‹é—´æ˜¯äº’ç›¸æ’æ–¥çš„å…³ç³»,ä¸æ˜¯åŒ…å«å…³ç³».</p>
</blockquote>
<p>ä¸€è„¸æ‡µäº†å§ğŸ˜³?é—®é¢˜ä¸å¤§,ç»“åˆä»£ç å…·ä½“çœ‹ä¸€ä¸‹å°±å·®ä¸å¤šäº†</p>
<p>æˆ‘ä»¬è¿˜æ˜¯ç»“åˆ java å’Œ kotlin å¯¹æ¯”æ¥çœ‹ä¸€ä¸‹</p>
<h3 id="Javaä¸­çš„æ³›å‹"><a href="#Javaä¸­çš„æ³›å‹" class="headerlink" title="Javaä¸­çš„æ³›å‹"></a>Javaä¸­çš„æ³›å‹</h3><p>æˆ‘ä»¬å…ˆç”¨Javaä»£ç æ¥çœ‹ä¸€ä¸‹,å‡å¦‚æˆ‘ä»¬æœ‰å¦‚ä¸‹ä¸‰ä¸ªç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> &#123;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Animal</span> &#123;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Poodle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Dog</span> &#123;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Bird</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Animal</span> &#123;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>ç”±äº java çš„å¤šæ€æ€§,æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå†™</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Animal</span> <span class="hljs-variable">animalDog</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>();<br><span class="hljs-type">Animal</span> <span class="hljs-variable">animalBird</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Bird</span>();<br>ArrayList&lt;Animal&gt; animalList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>animalList.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Bird</span>());<br>animalList.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>());<br></code></pre></td></tr></table></figure>
<p>è¿™ä¹ˆå†™æ˜¯æ²¡é—®é¢˜çš„,æˆ‘ä»¬å¯ä»¥æŠŠå­ç±»æ·»åŠ åˆ°çˆ¶ç±»åˆ—è¡¨ä¸­,ä½†å½“æˆ‘ä»¬åœ¨<code>animalList</code>ä¸­è·å–æ•°æ®æ—¶è¿”å›çš„æ˜¯<code>Animal</code>ç±»å‹,å¦‚æœç”¨åˆ°å­ç±»çš„ç‰¹æ€§,è¿˜éœ€è¦ä½¿ç”¨<code>instanceof</code>æ¥åˆ¤æ–­ä¸€ä¸‹ç±»å‹.<br>ä½†å¦‚æœæˆ‘ä»¬è¿™ä¹ˆå†™æ˜¯ä¸è¡Œçš„</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Java">ArrayList&lt;Animal&gt; animalList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Dog&gt;();<br></code></pre></td></tr></table></figure>
<p>å› ä¸º java çš„æ³›å‹å…·æœ‰ä¸å˜æ€§,åœ¨Java é‡Œé¢è®¤ä¸º<code>ArrayList&lt;Animal&gt;</code>å’Œ<code>ArrayList&lt;Dog&gt;</code>æ²¡å•¥å…³ç³».<br>åŒæ ·çš„,å½“æˆ‘ä»¬æƒ³è¦ç”¨æ–¹æ³•é‡è½½æ—¶ä¹Ÿä¼šé‡åˆ°è¿™ç§æƒ…å†µ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">animal</span><span class="hljs-params">(ArrayList&lt;Dog&gt; dogs)</span>&#123;<br>    <br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">animal</span><span class="hljs-params">(ArrayList&lt;Bird&gt; birds)</span>&#123;<br>    <br>&#125;<br></code></pre></td></tr></table></figure>
<p>å¦‚æœæˆ‘ä»¬è¿™ä¹ˆå†™çš„è¯ä¼šæŠ¥é”™,IDE ä¼šæç¤ºæˆ‘ä»¬ç›¸åº”çš„ä¿¡æ¯</p>
<blockquote>
<p>animal(ArrayList<Dog>)â€™ clashes with â€˜animal(ArrayList<Bird>)â€™; both methods have same erasure</p>
</blockquote>
<p>ä¸¤ä¸ªæ–¹æ³•çš„å‚æ•°æœ‰ç›¸åŒçš„æ“¦é™¤ç±»å‹,ç¼–è¯‘åä¼šè¢«è®¤ä¸ºæ˜¯åŒä¸€ä¸ªæ–¹æ³•.<br>åŒæ ·çš„,æˆ‘ä»¬åœ¨<strong>æ•è·æ³›å‹å¼‚å¸¸</strong>æ—¶ä¹Ÿä¼šæœ‰ç±»ä¼¼çš„æŠ¥é”™ä¿¡æ¯.</p>
<h3 id="Javaä¸­çš„æ³›å‹æ“¦é™¤"><a href="#Javaä¸­çš„æ³›å‹æ“¦é™¤" class="headerlink" title="Javaä¸­çš„æ³›å‹æ“¦é™¤"></a>Javaä¸­çš„æ³›å‹æ“¦é™¤</h3><p>é¢è¯•å¸¸è§çš„å…«è‚¡æ–‡,æˆ‘ä»¬æ¥å¤ä¹ ä¸€ä¸‹,è¿™éƒ¨åˆ†å¯ä»¥è·³è¿‡ä¸çœ‹.<br>æ¯”å¦‚æˆ‘ä»¬åœ¨C#ä¸­æœ‰å¦‚ä¸‹ä»£ç </p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs C#"><span class="hljs-keyword">using</span> System; <br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>&#123; <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params">String[] args</span>)</span>&#123; <br>        test&lt;<span class="hljs-built_in">string</span>&gt;(); <br>    &#125;    <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span>&lt;<span class="hljs-title">T</span>&gt;()</span>&#123; <br>        Console.WriteLine(<span class="hljs-keyword">typeof</span>(T)); <br>    &#125; <br>&#125; <br></code></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„æ³›å‹ T ç±»å‹string æ˜¯å¯ä»¥åœ¨è¿è¡Œæ—¶è·å–åˆ°çš„,å¹¶ä¸”åœ¨è¿™é‡Œæ˜¯ä¸€ä¸ªçœŸå®å¯ç”¨çš„ç±»å‹.<br>ä½†åœ¨Javaæ˜¯ä¸è¡Œçš„,ç”±äºå‘ä¸Šå…¼å®¹å†å²ä»£ç çš„åŸå›  Java é‡‡ç”¨äº†<code>Code sharing</code>çš„ç­–ç•¥,ä½¿å¾—æ³›å‹åªå­˜åœ¨äºæºç é˜¶æ®µ,ç¼–è¯‘è¿‡åçš„Classæ–‡ä»¶å¹¶ä¸å­˜åœ¨æ³›å‹,è™šæ‹Ÿæœºå¹¶ä¸çŸ¥é“æ³›å‹çš„å­˜åœ¨,æ‰€ä»¥è¯´Javaä¸­çš„æ³›å‹æ˜¯ä¸€ç§ä¼ªæ³›å‹,è¿™ç§å‚æ•°ç±»å‹åªå­˜åœ¨äºæºç é˜¶æ®µåœ¨ç¼–è¯‘åå¹¶ä¸å­˜åœ¨çš„æœºåˆ¶æˆ‘ä»¬å«åš<strong>æ³›å‹æ“¦é™¤</strong>.ä¸ºäº†ä¿æŒæ³›å‹ç»§æ‰¿æˆ–å®ç°å…³ç³»çš„æ­£ç¡®æ€§,java ä¸­è¿˜æœ‰ä¸€ç§ç­–ç•¥ï¼š<strong>æ¡¥æ–¹æ³•ç”Ÿæˆ(Bridge Method Generation)</strong>:<br>ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´æ˜æ¡¥æ–¹æ³•ç”Ÿæˆï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Shape</span>&lt;T&gt; &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">draw</span><span class="hljs-params">(T shape)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;Drawing shape: &quot;</span> + shape.toString());<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Circle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span>&lt;String&gt; &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">draw</span><span class="hljs-params">(String shape)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;Drawing circle: &quot;</span> + shape);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>åœ¨ç±»å‹æ“¦é™¤å,ç¼–è¯‘å™¨ä¼šç”Ÿæˆæ¡¥æ–¹æ³•æ¥ä¿æŒæ³›å‹ç»§æ‰¿å…³ç³»çš„æ­£ç¡®æ€§.åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­,ç¼–è¯‘å™¨ä¼šç”Ÿæˆä¸€ä¸ªæ¡¥æ–¹æ³•,ä½¿å¾—Circleç±»çš„æ–¹æ³•ç­¾åä¸çˆ¶ç±»çš„æ–¹æ³•ç­¾åä¿æŒä¸€è‡´,ä½†è¿”å›ç±»å‹è¢«æ“¦é™¤ä¸ºçˆ¶ç±»çš„ç±»å‹å‚æ•°.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Circle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span>&lt;String&gt; &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">draw</span><span class="hljs-params">(String shape)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;Drawing circle: &quot;</span> + shape);<br>    &#125;<br><br>    <span class="hljs-comment">// ç”Ÿæˆçš„æ¡¥æ–¹æ³•</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">draw</span><span class="hljs-params">(Object shape)</span> &#123;<br>        draw((String) shape);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>é€šè¿‡ç”Ÿæˆçš„æ¡¥æ–¹æ³•,å³draw(Object shape),åœ¨ç±»å‹æ“¦é™¤åä»ç„¶èƒ½å¤Ÿæ­£ç¡®åœ°è°ƒç”¨æ³›å‹æ–¹æ³•.è¿™æ ·,å³ä½¿åœ¨ç¼–è¯‘å™¨çœ‹ä¸åˆ°å…·ä½“çš„æ³›å‹ç±»å‹ä¿¡æ¯,ä»ç„¶å¯ä»¥é€šè¿‡æ¡¥æ–¹æ³•æ¥è°ƒç”¨æ­£ç¡®çš„æ–¹æ³•å®ç°.<br>æ„Ÿå…´è¶£çš„è¯å¯ä»¥æœä¸€ä¸‹å…³é”®å­—:æ³›å‹æ“¦é™¤ã€æ¡¥æ–¹æ³•ç”Ÿæˆã€Code sharinã€Code specialization</p>
<h3 id="Java-ä¸­çš„æ³›å‹é€šé…ç¬¦"><a href="#Java-ä¸­çš„æ³›å‹é€šé…ç¬¦" class="headerlink" title="Java ä¸­çš„æ³›å‹é€šé…ç¬¦"></a>Java ä¸­çš„æ³›å‹é€šé…ç¬¦</h3><p>å‡å¦‚æˆ‘ä»¬çœŸçš„æœ‰åƒä¸Šé¢é‚£ç§èµ‹å€¼éœ€æ±‚æ€ä¹ˆæï¼Ÿjava ç»™æˆ‘ä»¬æä¾›äº†<code>æ³›å‹é€šé…ç¬¦</code>: <strong>? extends</strong> å’Œ <strong>? super</strong> æ¥è§£å†³è¿™ä¸ªé—®é¢˜.<br>å•°å—¦ä¸€ä¸‹ï¼šåœ¨ç»§æ‰¿å…³ç³»ä¸Š,ä¸€èˆ¬æƒ…å†µä¸‹å°†çˆ¶ç±»æ”¾åœ¨ä¸Šæ–¹,å­ç±»æ”¾åœ¨ä¸‹æ–¹.æ¯”å¦‚ä¸Šé¢å®šä¹‰çš„ç±»</p>

<pre>
<code class="mermaid" >
graph TB

A(Animal)
A10(Dog)
A11(Bird)
A20(Poodle)
A-->A10
A-->A11
A10-->A20

</code>
</pre>


<h4 id="extends"><a href="#extends" class="headerlink" title="? extends"></a>? extends</h4><p>æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå†™</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Java">ArrayList&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Animal</span>&gt; arrayList ;<br>arrayList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Bird&gt;();<br>arrayList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Dog&gt;();<br>arrayList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Animal&gt;();<br></code></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„<code>? extends</code>å«åš<strong>ä¸Šç•Œé€šé…ç¬¦</strong>,å¯ä»¥ä½¿ Java æ³›å‹å…·æœ‰<strong>åå˜æ€§ Covariance</strong>,åå˜å°±æ˜¯å…è®¸ä¸Šé¢çš„èµ‹å€¼æ˜¯åˆæ³•çš„.<br>ä¸è¿‡è¿™é‡Œçš„<code>extends</code>å’Œæˆ‘ä»¬å®šä¹‰<code>class</code>æ—¶ç»§æ‰¿æŸä¸ªç±»ç”¨çš„<code>extends</code>æœ‰ä¸€ç‚¹ç‚¹ä¸ä¸€æ ·,é™¤äº†ä¸Šç•Œæ‰€æœ‰çš„ç›´æ¥å­ç±»ã€é—´æ¥å­ç±»è¿˜åŒ…å«å®ƒæœ¬èº«,å¹¶ä¸”ä¸Šç•Œä¹Ÿå¯ä»¥æ˜¯ interface.<br>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­,<code>ArrayList&lt;? extends Animal&gt;</code>è¡¨ç¤ºåˆ—è¡¨ä¸­å¯ä»¥å­˜æ”¾ Animal åŠå…¶å­ç±»ã€é—´æ¥å­ç±»çš„ç±»å‹.ä¹Ÿå°±æ˜¯ç¡®è®¤äº†å®ƒçš„ä¸Šé™èƒ½åˆ°å“ªä¸€å±‚.<br>ä½†æˆ‘ä»¬åœ¨ä½¿ç”¨çš„æ³›å‹é€šé…ç¬¦ä¹‹å,åœ¨ä½¿ç”¨ä¸Šä¼šæœ‰ä¸€äº›å°é—®é¢˜ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Java">arrayList.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>());<span class="hljs-comment">//error</span><br>arrayList.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Bird</span>());<span class="hljs-comment">//error</span><br>arrayList.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>());<span class="hljs-comment">//error</span><br><span class="hljs-type">Animal</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span>  arrayList.get(<span class="hljs-number">0</span>);<span class="hljs-comment">//ok</span><br></code></pre></td></tr></table></figure>

<p>ç”±äº<code>arrayList</code>ä¸­å­˜æ”¾çš„å¯ä»¥æ˜¯<strong>Animal åŠå…¶å­ç±»ã€é—´æ¥å­ç±»çš„ç±»å‹</strong>,æ‰€ä»¥æˆ‘ä»¬å¹¶ä¸ç¡®å®šæ˜¯å“ªç§ç±»å‹,å› æ­¤æˆ‘ä»¬æ— æ³•å‘åˆ—è¡¨ä¸­æ·»åŠ å…ƒç´ ,ä½†å¯ä»¥ç¡®å®šçš„æ˜¯,å°†åˆ—è¡¨ä¸­çš„å…ƒç´ èµ‹å€¼ç»™ Animalç±»å‹çš„å˜é‡æ˜¯æ²¡é—®é¢˜çš„.<br>åƒè¿™ç§åªèƒ½ä»åˆ—è¡¨ä¸­è¯»å–æ•°æ®æä¾›,ä½†ä¸èƒ½å‘åˆ—è¡¨ä¸­å†™å…¥çš„æƒ…å†µæˆ‘ä»¬ç§°ä¹‹ä¸º<code>ç”Ÿäº§è€…</code></p>
<h4 id="super"><a href="#super" class="headerlink" title="? super"></a>? super</h4><p>æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå†™</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Java">ArrayList&lt;? <span class="hljs-built_in">super</span> Dog&gt; list ;<br>list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Dog&gt;();<br>list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Animal&gt;();<br>list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Poodle&gt;();<span class="hljs-comment">//error</span><br><br></code></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„<code>? super</code>å«åš<strong>ä¸‹ç•Œé€šé…ç¬¦</strong>,å¯ä»¥ä½¿Javaæ³›å‹å…·<strong>é€†å˜æ€§ Contravariance</strong>,é€†å˜å°±æ˜¯å…è®¸ä¸Šé¢çš„èµ‹å€¼æ˜¯åˆæ³•çš„.<br>é€šè¿‡ä»£ç æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸‹ç•Œé€šé…ç¬¦ç¡®å®šäº†åˆ—è¡¨çš„ä¸‹é™,ä¹Ÿå°±æ˜¯ç¡®è®¤äº†ä¸‹é™åœ¨å“ªä¸€å±‚,æˆ‘ä»¬å¯ä»¥å°†è¯¥å±‚åŠä»¥ä¸Šçš„ç±»å‹èµ‹å€¼ç»™ list.åŒæ ·çš„,æˆ‘ä»¬åœ¨ä½¿ç”¨ä¸Šä¹Ÿæœ‰ä¸€ç‚¹ç‚¹å°é—®é¢˜ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Java">list.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>());<br>list.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Poodle</span>());<br>list.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>());<span class="hljs-comment">//error</span><br><br><span class="hljs-type">Object</span> <span class="hljs-variable">dog</span> <span class="hljs-operator">=</span> list.get(<span class="hljs-number">0</span>);<br></code></pre></td></tr></table></figure>
<p>å› ä¸ºlist ä¸­å­˜æ”¾çš„è‚¯å®šæ˜¯<strong>Dogæˆ–è€…å…¶çˆ¶ç±»ã€é—´æ¥çˆ¶ç±»</strong>,æ ¹æ®é‡Œæ°æ›¿æ¢åŸåˆ™,ä»»ä½•ä½¿ç”¨çˆ¶ç±»çš„åœ°æ–¹å¯ä»¥è¢«å®ƒçš„å­ç±»æ›¿æ¢,æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å‘ list ä¸­æ·»åŠ <strong>Dogæˆ–å…¶å­ç±»ã€é—´æ¥å­ç±»</strong>.ä½†æ˜¯å½“æˆ‘ä»¬ä» list ä¸­å–æ•°æ®çš„æ—¶å€™,ç”±äºä¸çŸ¥é“ list ä¸­å­˜æ”¾çš„å…·ä½“æ˜¯ä»€ä¹ˆç±»å‹,åœ¨ java ä¸­ Object æ˜¯æ‰€æœ‰ç±»å‹çš„çˆ¶ç±»,æ‰€ä»¥è¿™é‡Œå–åˆ°çš„æ•°æ®è¿”å›çš„<strong>Object</strong>ç±»å‹.</p>
<p>ä¸€èˆ¬æƒ…å†µä¸‹,æˆ‘ä»¬è·å–åˆ°Objectå¯ä»¥é€šè¿‡<code>className</code>æˆ–è€…<code>instanceof</code>æ¥åˆ¤æ–­å…·ä½“ç±»å‹,ä½†æˆ‘ä»¬å°±å…ˆå¿½ç•¥å§.<br>åƒè¿™ç§åªå†™å…¥è€Œä¸è¯»å–çš„æ³›å‹ç±»å‹å£°æ˜æƒ…å†µç§°ä¹‹ä¸º<strong>æ¶ˆè´¹è€… Consumer</strong>.</p>
<h4 id="æ— è¾¹ç•Œé€šé…ç¬¦"><a href="#æ— è¾¹ç•Œé€šé…ç¬¦" class="headerlink" title="æ— è¾¹ç•Œé€šé…ç¬¦"></a>æ— è¾¹ç•Œé€šé…ç¬¦</h4><p>è¿˜æœ‰ä¸€ç§æ— è¾¹ç•Œé€šé…ç¬¦,ç”¨å•é—®å·è¡¨ç¤ºï¼šList&lt;?&gt;,ä¹Ÿå°±æ˜¯æ²¡æœ‰ä»»ä½•é™å®š,ç›¸å½“äº<code>? extends Object</code>.éœ€è¦æ³¨æ„çš„æ˜¯,å®ƒå’Œä¸ä½¿ç”¨ç±»å‹çš„ List è¿˜æ˜¯æœ‰åŒºåˆ«çš„ï¼š</p>
<ul>
<li>List&lt;?&gt; listè¡¨ç¤ºçš„æ˜¯åˆ—è¡¨ä¿å­˜æŸä¸ªç‰¹å®šç±»å‹çš„å¯¹è±¡,ä½†æˆ‘ä»¬ä¸èƒ½å‘å…¶ä¸­æ·»åŠ ä»»ä½•å…ƒç´ ,å› ä¸ºæˆ‘ä»¬ä¸æ¸…æ¥š list ä¸­ä¿å­˜çš„æ˜¯é‚£ç§ç±»å‹</li>
<li>æ²¡æœ‰æ³›å‹å‚æ•°çš„ List è¡¨ç¤ºè¯¥åˆ—è¡¨æŒæœ‰çš„å…ƒç´ ç±»å‹æ˜¯ Object,å› æ­¤å¯ä»¥æ·»åŠ ä»»ä½•ç±»å‹çš„å¯¹è±¡,ä½†ç¼–è¯‘å™¨ä¼šæœ‰è­¦å‘Šä¿¡æ¯.</li>
</ul>
<h4 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h4><p>å°å°çš„æ€»ç»“ä¸€ä¸‹ï¼š<br>åˆ©ç”¨<code>? extends</code>å½¢å¼çš„é€šé…ç¬¦å¯ä»¥å®ç°æ³›å‹çš„å‘ä¸Šè½¬å‹,ä¹Ÿå°±æ˜¯æ”¯æŒåå˜.ä½†ä½¿ç”¨ä¸Šé€šé…ç¬¦åç¼–è¯‘å™¨ä¸ºäº†ä¿è¯è¿è¡Œæ—¶çš„å®‰å…¨,ä¼šé™å®šå¯¹å…¶å†™çš„æ“ä½œ,å¼€æ”¾è¯»çš„æ“ä½œä¹Ÿå°±æ˜¯<strong>åªèƒ½è¯»å–ä¸èƒ½ä¿®æ”¹</strong><br>åˆ©ç”¨<code>? super T</code>å½¢å¼çš„é€šé…ç¬¦å¯ä»¥å®ç°æ³›å‹çš„å‘ä¸‹è½¬å‹,ä¹Ÿå°±æ˜¯æ”¯æŒé€†å˜,ä¸ä¸Šé€šé…ç¬¦ç›¸å,ä¸‹è¾¹ç•Œé€šé…ç¬¦é€šå¸¸é™å®šè¯»çš„æ“ä½œ,å¼€æ”¾å†™çš„æ“ä½œ,ä¹Ÿå°±æ˜¯<strong>åªèƒ½ä¿®æ”¹ä¸èƒ½è¯»å–</strong></p>
<p>Joshua Bloch åœ¨å…¶è‘—ä½œã€ŠEffective Javaã€‹ç¬¬ä¸‰ç‰ˆ ä¸­å¾ˆå¥½åœ°è§£é‡Šäº†è¯¥é—®é¢˜ (ç¬¬ 31 æ¡ï¼šâ€œåˆ©ç”¨æœ‰é™åˆ¶é€šé…ç¬¦æ¥æå‡ API çš„çµæ´»æ€§â€). ä»–ç§°é‚£äº›ä½ åªèƒ½ä»ä¸­è¯»å–çš„å¯¹è±¡ä¸ºç”Ÿäº§è€…, å¹¶ç§°é‚£äº›åªèƒ½å‘å…¶å†™å…¥çš„å¯¹è±¡ä¸ºæ¶ˆè´¹è€….ä»–å»ºè®®ï¼š</p>
<blockquote>
<p>ä¸ºäº†çµæ´»æ€§æœ€å¤§åŒ–,åœ¨è¡¨ç¤ºç”Ÿäº§è€…æˆ–æ¶ˆè´¹è€…çš„è¾“å…¥å‚æ•°ä¸Šä½¿ç”¨é€šé…ç¬¦ç±»å‹.</p>
</blockquote>
<p>ä»–è¿˜æå‡ºäº†ä»¥ä¸‹åŠ©è®°ç¬¦ï¼šPECS ä»£è¡¨ç”Ÿäº§è€…-Extendsã€æ¶ˆè´¹è€…-Super(Producer-Extends, Consumer-Super).</p>
<h3 id="kotlin-ä¸­çš„æ³›å‹é€šé…ç¬¦"><a href="#kotlin-ä¸­çš„æ³›å‹é€šé…ç¬¦" class="headerlink" title="kotlin ä¸­çš„æ³›å‹é€šé…ç¬¦"></a>kotlin ä¸­çš„æ³›å‹é€šé…ç¬¦</h3><p>ç†æ¸…æ¥šäº† java ä¸­çš„æ³›å‹é€šé…ç¬¦,æ¥ç€æˆ‘ä»¬çœ‹ä¸€ä¸‹ kotlin ä¸­çš„é€šé…ç¬¦,ç›¸å¯¹äº Java çš„é€šé…ç¬¦æå‡ºäº†ä¸€ç§æ–°çš„å®šä¹‰ï¼š<strong>å£°æ˜å¤„å‹å˜(declaration-site variance)<strong>ä¸</strong>ç±»å‹æŠ•å½±(type projections)</strong><br>å…ˆä» kotlin ä¸­çš„é€šé…ç¬¦è¯´èµ·ï¼š<br>å’Œ java æ³›å‹ä¸€æ ·ï¼Œkotlin ä¸­çš„æ³›å‹ä¹Ÿæ˜¯ä¸å˜çš„ï¼ŒåŒæ ·çš„ï¼Œä¹Ÿæä¾›äº†ç›¸åº”çš„å…³é”®å­—æ¥æ”¯æŒ<strong>åå˜</strong>å’Œ<strong>é€†å˜</strong></p>
<ul>
<li>ä½¿ç”¨å…³é”®å­—<code>out</code>æ¥æ”¯æŒåå˜ï¼Œç­‰åŒäº Java ä¸­çš„ä¸Šç•Œé€šé…ç¬¦<code>? extends</code>ã€‚</li>
<li>ä½¿ç”¨å…³é”®å­—<code>in</code>æ¥æ”¯æŒé€†å˜ï¼Œç­‰åŒäº Java ä¸­çš„ä¸‹ç•Œé€šé…ç¬¦<code>? super</code>ã€‚</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> outList: MutableList&lt;<span class="hljs-keyword">out</span> TestMain.Animal&gt; = mutableListOf()<br><span class="hljs-keyword">val</span> outListItem: TestMain.Animal = outList[<span class="hljs-number">0</span>]<br><br><br><span class="hljs-keyword">val</span> inList: MutableList&lt;<span class="hljs-keyword">in</span> TestMain.Animal&gt; = mutableListOf()<br>inList.add(TestMain.Dog())<br>inList.add(TestMain.Bird())<br>inList.add(TestMain.Poodle())<br><span class="hljs-keyword">val</span> inListItem: Any? = inList[<span class="hljs-number">0</span>]<br></code></pre></td></tr></table></figure>
<p>æ— éæ˜¯æ¢äº†ä¸ªå†™æ³•è€Œå·²ï¼Œæ²¡å¤šå¤§å·®åˆ«.ä¸è¿‡éœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œkotlin åŒæ—¶æ”¯æŒä½¿ç”¨å¤„å‹å˜å’Œå£°æ˜å¤„å‹å˜ã€‚<br>ä¸¾ä¸€ä¸ªç”¨çƒ‚äº†çš„ä¾‹å­</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Producer</span>&lt;<span class="hljs-type">out T</span>&gt; </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">produce</span><span class="hljs-params">()</span></span>: T &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span> <span class="hljs-keyword">as</span> T<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Consumer</span>&lt;<span class="hljs-type">in T</span>&gt; </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">consume</span><span class="hljs-params">(t: <span class="hljs-type">T</span>)</span></span> &#123;<br>        println(t)<br>    &#125;<br>&#125;<br><span class="hljs-keyword">val</span> producer: Producer&lt;TestMain.Animal&gt; = Producer()<br><span class="hljs-keyword">val</span> animal: TestMain.Animal = producer.produce()<br><br><span class="hljs-keyword">val</span> consumer: Consumer&lt;TestMain.Animal&gt; = Consumer()<br>consumer.consume(TestMain.Dog())<br></code></pre></td></tr></table></figure>
<p>å¦‚æœæˆ‘ä»¬ç¡®è®¤æ³›å‹å‚æ•°åªç”¨æ¥è¾“å…¥æˆ–è€…è¾“å‡ºï¼Œå¯ä»¥åœ¨å£°æ˜å¤„ç›´æ¥æ·»åŠ <code>in</code>æˆ–è€…<code>out</code>.å½“ç„¶ä¹Ÿå¯ä»¥åœ¨ä½¿ç”¨å¤„æ·»åŠ å£°æ˜</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Producer1</span>&lt;<span class="hljs-type">T</span>&gt; </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">produce</span><span class="hljs-params">()</span></span>: T? &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span><br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Consumer1</span>&lt;<span class="hljs-type">T</span>&gt; </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">consume</span><span class="hljs-params">(t: <span class="hljs-type">T</span>)</span></span> &#123;<br>        println(t)<br>    &#125;<br>&#125;<br><span class="hljs-keyword">val</span> producer1: Producer1&lt;<span class="hljs-keyword">out</span> TestMain.Animal&gt; = Producer1()<br><span class="hljs-keyword">val</span> animal1: TestMain.Animal? = producer1.produce()<br><br><span class="hljs-keyword">val</span> consumer1: Consumer1&lt;<span class="hljs-keyword">in</span> TestMain.Animal&gt; = Consumer1()<br>consumer1.consume(TestMain.Dog())<br></code></pre></td></tr></table></figure>
<p>è¿™é‡Œä¹Ÿå°±æ˜¯ç»å¸¸è¯´çš„ <strong>æ¶ˆè´¹è€… in, ç”Ÿäº§è€… out</strong></p>
<h4 id="ç±»å‹æŠ•å½±"><a href="#ç±»å‹æŠ•å½±" class="headerlink" title="ç±»å‹æŠ•å½±"></a>ç±»å‹æŠ•å½±</h4><p>è¿™ä¸ªä¸œè¥¿å¯ä»¥ç†è§£ä¸ºå°±æ˜¯ä¸€ä¸ªæ¦‚å¿µï¼Œæ ¹æ®å®˜æ–¹æè¿°æ˜¯è¿™æ ·çš„:<br>å°†ç±»å‹å‚æ•°<code>T</code>å£°æ˜ä¸º<code>out</code>éå¸¸ç®€å•ï¼Œå¹¶ä¸”èƒ½é¿å…ä½¿ç”¨å¤„å­ç±»å‹åŒ–çš„éº»çƒ¦ï¼Œä½†æ˜¯æœ‰äº›ç±»å®é™…ä¸Šä¸èƒ½é™åˆ¶ä¸ºåªè¿”å›<code>T</code>ï¼ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ˜¯<code>Array</code>ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Array</span>&lt;<span class="hljs-type">T</span>&gt;</span>(<span class="hljs-keyword">val</span> size: <span class="hljs-built_in">Int</span>) &#123;<br>    <span class="hljs-keyword">operator</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">get</span><span class="hljs-params">(index: <span class="hljs-type">Int</span>)</span></span>: T &#123; â€¦â€¦ &#125;<br>    <span class="hljs-keyword">operator</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">set</span><span class="hljs-params">(index: <span class="hljs-type">Int</span>, value: <span class="hljs-type">T</span>)</span></span> &#123; â€¦â€¦ &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>è¯¥ç±»åœ¨<code>T</code>ä¸Šæ—¢ä¸èƒ½æ˜¯åå˜çš„ä¹Ÿä¸èƒ½æ˜¯é€†å˜çš„ã€‚è¿™é€ æˆäº†ä¸€äº›ä¸çµæ´»æ€§ã€‚è€ƒè™‘ä¸‹è¿°å‡½æ•°ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">copy</span><span class="hljs-params">(from: <span class="hljs-type">Array</span>&lt;<span class="hljs-type">Any</span>&gt;, to: <span class="hljs-type">Array</span>&lt;<span class="hljs-type">Any</span>&gt;)</span></span> &#123;<br>    assert(from.size == to.size)<br>    <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> from.indices)<br>        to[i] = from[i]<br>&#125;<br></code></pre></td></tr></table></figure>
<p>è¿™ä¸ªå‡½æ•°åº”è¯¥å°†é¡¹ç›®ä»ä¸€ä¸ªæ•°ç»„å¤åˆ¶åˆ°å¦ä¸€ä¸ªæ•°ç»„ã€‚è®©æˆ‘ä»¬å°è¯•åœ¨å®è·µä¸­åº”ç”¨å®ƒï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> ints: Array&lt;<span class="hljs-built_in">Int</span>&gt; = arrayOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>)<br><span class="hljs-keyword">val</span> any = Array&lt;Any&gt;(<span class="hljs-number">3</span>) &#123; <span class="hljs-string">&quot;&quot;</span> &#125; <br>copy(ints, any)<br><span class="hljs-comment">//   ^ å…¶ç±»å‹ä¸º Array&lt;Int&gt; ä½†æ­¤å¤„æœŸæœ› Array&lt;Any&gt;</span><br></code></pre></td></tr></table></figure>
<p>è¿™é‡Œæˆ‘ä»¬é‡åˆ°åŒæ ·ç†Ÿæ‚‰çš„é—®é¢˜ï¼š<code>Array&lt;T&gt;</code>åœ¨<code>T</code>ä¸Šæ˜¯<strong>ä¸å‹å˜</strong>çš„ï¼Œå› æ­¤<code>Array&lt;Int&gt;</code> ä¸ <code>Array&lt;Any&gt;</code> éƒ½ä¸æ˜¯å¦ä¸€ä¸ªçš„å­ç±»å‹ã€‚ä¸ºä»€ä¹ˆï¼Ÿ å†æ¬¡é‡å¤ï¼Œå› ä¸º<code>copy</code>å¯èƒ½æœ‰éé¢„æœŸè¡Œä¸ºï¼Œä¾‹å¦‚å®ƒå¯èƒ½å°è¯•å†™ä¸€ä¸ª<code>String</code>åˆ°<code>from</code>ï¼Œå¹¶ä¸”å¦‚æœæˆ‘ä»¬å®é™…ä¸Šä¼ é€’ä¸€ä¸ª<code>Int</code>çš„æ•°ç»„ï¼Œä»¥åä¼šæŠ›<code>ClassCastException</code>å¼‚å¸¸ã€‚<br>å¦‚æœéœ€è¦ç¦æ­¢<code>copy</code>åŠŸèƒ½å†™å…¥<code>from</code>ï¼Œå¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œ:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">copy</span><span class="hljs-params">(from: <span class="hljs-type">Array</span>&lt;<span class="hljs-type">out</span> <span class="hljs-type">Any</span>&gt;, to: <span class="hljs-type">Array</span>&lt;<span class="hljs-type">Any</span>&gt;)</span></span> &#123; â€¦â€¦ &#125;<br></code></pre></td></tr></table></figure>
<p>è¿™å°±æ˜¯ç±»å‹æŠ•å½±ï¼šæ„å‘³ç€<code>from</code>ä¸ä»…ä»…æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè€Œæ˜¯ä¸€ä¸ª<code>å—é™åˆ¶</code>çš„<strong>ï¼ˆæŠ•å½±çš„ï¼‰</strong>æ•°ç»„ã€‚ åªå¯ä»¥è°ƒç”¨è¿”å›ç±»å‹ä¸ºç±»å‹å‚æ•°<code>T</code>çš„æ–¹æ³•ï¼Œå¦‚ä¸Šï¼Œè¿™æ„å‘³ç€åªèƒ½è°ƒç”¨<code>get()</code>ã€‚ è¿™å°±æ˜¯ä½¿ç”¨å¤„å‹å˜çš„ç”¨æ³•ï¼Œå¹¶ä¸”æ˜¯å¯¹åº”äº Java çš„ <code>Array&lt;? extends Object&gt;</code>, ä½†æ›´ç®€å•ã€‚</p>
<p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨<code>in</code>æŠ•å½±ä¸€ä¸ªç±»å‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fill</span><span class="hljs-params">(dest: <span class="hljs-type">Array</span>&lt;<span class="hljs-type">in</span> <span class="hljs-type">String</span>&gt;, value: <span class="hljs-type">String</span>)</span></span> &#123; â€¦â€¦ &#125;<br></code></pre></td></tr></table></figure>
<p><code>Array&lt;in String&gt;</code> å¯¹åº”äº Java çš„<code>Array&lt;? super String&gt;</code>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä½ å¯ä»¥ä¼ é€’ä¸€ä¸ª<code>CharSequence</code>æ•°ç»„æˆ–ä¸€ä¸ª<code>Object</code>æ•°ç»„ç»™<code>fill()</code>å‡½æ•°ã€‚<br><strong>ä»¥ä¸Šä¿¡æ¯æ¥è‡ª <a href="(https://book.kotlincn.net/text/generics.html)">kotlin ä¸­æ–‡ç½‘</a></strong></p>
<h4 id="æ˜ŸæŠ•å½±"><a href="#æ˜ŸæŠ•å½±" class="headerlink" title="æ˜ŸæŠ•å½±"></a>æ˜ŸæŠ•å½±</h4><p>æœ‰æ—¶ä½ æƒ³è¯´ï¼Œä½ å¯¹ç±»å‹å‚æ•°ä¸€æ— æ‰€çŸ¥ï¼Œä½†ä»ç„¶å¸Œæœ›ä»¥å®‰å…¨çš„æ–¹å¼ä½¿ç”¨å®ƒã€‚ è¿™é‡Œçš„å®‰å…¨æ–¹å¼æ˜¯å®šä¹‰æ³›å‹ç±»å‹çš„è¿™ç§æŠ•å½±ï¼Œè¯¥æ³›å‹ç±»å‹çš„æ¯ä¸ªå…·ä½“å®ä¾‹åŒ–éƒ½ä¼šæ˜¯è¯¥æŠ•å½±çš„å­ç±»å‹ã€‚</p>
<p>Kotlin ä¸ºæ­¤æä¾›äº†æ‰€è°“çš„<strong>æ˜ŸæŠ•å½±</strong>è¯­æ³•ï¼š</p>
<ul>
<li>å¯¹äº<code>Foo &lt;out T : TUpper&gt;</code>ï¼Œå…¶ä¸­<code>T</code>æ˜¯ä¸€ä¸ªå…·æœ‰ä¸Šç•Œ<code>TUpper</code>çš„åå˜ç±»å‹å‚æ•°ï¼Œ<code>Foo &lt;*&gt;</code>ç­‰ä»·äº<code>Foo &lt;out TUpper&gt;</code>ã€‚ æ„å‘³ç€å½“<code>T</code>æœªçŸ¥æ—¶ï¼Œä½ å¯ä»¥å®‰å…¨åœ°ä»<code>Foo &lt;*&gt;</code>è¯»å–<code>TUpper</code>çš„å€¼ã€‚</li>
<li>å¯¹äº<code>Foo &lt;in T&gt;</code>ï¼Œå…¶ä¸­<code>T</code>æ˜¯ä¸€ä¸ªé€†å˜ç±»å‹å‚æ•°ï¼Œ<code>Foo &lt;*&gt;</code>ç­‰ä»·äº<code>Foo &lt;in Nothing&gt;</code>ã€‚ æ„å‘³ç€å½“<code>T</code>æœªçŸ¥æ—¶ï¼Œ æ²¡æœ‰ä»€ä¹ˆå¯ä»¥ä»¥å®‰å…¨çš„æ–¹å¼å†™å…¥<code>Foo &lt;*&gt;</code>ã€‚</li>
<li>å¯¹äº<code>Foo &lt;T : TUpper&gt;</code>ï¼Œå…¶ä¸­<code>T</code>æ˜¯ä¸€ä¸ªå…·æœ‰ä¸Šç•Œ<code>TUpper</code>çš„ä¸å‹å˜ç±»å‹å‚æ•°,<code>Foo&lt;*&gt;</code>å¯¹äºè¯»å–å€¼æ—¶ç­‰ä»·äº<code>Foo&lt;out TUpper&gt;</code> è€Œå¯¹äºå†™å€¼æ—¶ç­‰ä»·äº<code>Foo&lt;in Nothing&gt;</code>ã€‚</li>
</ul>
<p>å¦‚æœæ³›å‹ç±»å‹å…·æœ‰å¤šä¸ªç±»å‹å‚æ•°ï¼Œåˆ™æ¯ä¸ªç±»å‹å‚æ•°éƒ½å¯ä»¥å•ç‹¬æŠ•å½±ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœç±»å‹è¢«å£°æ˜ä¸º interface Function &lt;in T, out U&gt;ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ˜ŸæŠ•å½±ï¼š</p>
<ul>
<li><code>Function&lt;*, String&gt;</code> è¡¨ç¤º<code>Function&lt;in Nothing, String&gt;</code>ã€‚</li>
<li><code>Function&lt;Int, *&gt;</code> è¡¨ç¤º<code>Function&lt;Int, out Any?&gt;</code>ã€‚</li>
<li><code>Function&lt;*, *&gt;</code> è¡¨ç¤º<code>Function&lt;in Nothing, out Any?&gt;</code>ã€‚</li>
</ul>
<p><strong>ä»¥ä¸Šä¿¡æ¯æ¥è‡ª <a href="(https://book.kotlincn.net/text/generics.html)">kotlin ä¸­æ–‡ç½‘</a></strong></p>
<h4 id="æ³›å‹æ–¹æ³•"><a href="#æ³›å‹æ–¹æ³•" class="headerlink" title="æ³›å‹æ–¹æ³•"></a>æ³›å‹æ–¹æ³•</h4><p>ä¸ä»…ç±»å¯ä»¥æœ‰ç±»å‹å‚æ•°ã€‚å‡½æ•°ä¹Ÿå¯ä»¥æœ‰ã€‚ç±»å‹å‚æ•°è¦æ”¾åœ¨å‡½æ•°åç§°ä¹‹å‰ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">singletonList</span><span class="hljs-params">(item: <span class="hljs-type">T</span>)</span></span>: List&lt;T&gt; &#123;<br>    <span class="hljs-comment">// â€¦â€¦</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> T.<span class="hljs-title">basicToString</span><span class="hljs-params">()</span></span>: String &#123; <span class="hljs-comment">// æ‰©å±•å‡½æ•°</span><br>    <span class="hljs-comment">// â€¦â€¦</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>è¦è°ƒç”¨æ³›å‹å‡½æ•°ï¼Œåœ¨è°ƒç”¨å¤„å‡½æ•°åä¹‹åæŒ‡å®šç±»å‹å‚æ•°å³å¯ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> l = singletonList&lt;<span class="hljs-built_in">Int</span>&gt;(<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure>

<p>å¯ä»¥çœç•¥èƒ½å¤Ÿä»ä¸Šä¸‹æ–‡ä¸­æ¨æ–­å‡ºæ¥çš„ç±»å‹å‚æ•°ï¼Œæ‰€ä»¥ä»¥ä¸‹ç¤ºä¾‹åŒæ ·é€‚ç”¨ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> l = singletonList(<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure>

<h4 id="æ³›å‹çº¦æŸ"><a href="#æ³›å‹çº¦æŸ" class="headerlink" title="æ³›å‹çº¦æŸ"></a>æ³›å‹çº¦æŸ</h4><p>èƒ½å¤Ÿæ›¿æ¢ç»™å®šç±»å‹å‚æ•°çš„æ‰€æœ‰å¯èƒ½ç±»å‹çš„é›†åˆå¯ä»¥ç”±<strong>æ³›å‹çº¦æŸ</strong>é™åˆ¶ã€‚<br>æœ€å¸¸è§çš„çº¦æŸç±»å‹æ˜¯ä¸Šç•Œï¼Œä¸Javaçš„<code>extends</code>å…³é”®å­—å¯¹åº”ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : Comparable&lt;T&gt;</span>&gt; <span class="hljs-title">sort</span><span class="hljs-params">(list: <span class="hljs-type">List</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span> &#123;  â€¦â€¦ &#125;<br></code></pre></td></tr></table></figure>
<p>å†’å·ä¹‹åæŒ‡å®šçš„ç±»å‹æ˜¯ä¸Šç•Œï¼Œè¡¨æ˜åªæœ‰<code>Comparable&lt;T&gt;</code>çš„å­ç±»å‹å¯ä»¥æ›¿ä»£<code>T</code>ã€‚ ä¾‹å¦‚ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">sort(listOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>)) <span class="hljs-comment">// OKã€‚Int æ˜¯ Comparable&lt;Int&gt; çš„å­ç±»å‹</span><br>sort(listOf(HashMap&lt;<span class="hljs-built_in">Int</span>, String&gt;())) <span class="hljs-comment">// é”™è¯¯ï¼šHashMap&lt;Int, String&gt; ä¸æ˜¯ Comparable&lt;HashMap&lt;Int, String&gt;&gt; çš„å­ç±»å‹</span><br></code></pre></td></tr></table></figure>
<p>é»˜è®¤çš„ä¸Šç•Œï¼ˆå¦‚æœæ²¡æœ‰å£°æ˜ï¼‰æ˜¯ Any?ã€‚åœ¨å°–æ‹¬å·ä¸­åªèƒ½æŒ‡å®šä¸€ä¸ªä¸Šç•Œã€‚ å¦‚æœåŒä¸€ç±»å‹å‚æ•°éœ€è¦å¤šä¸ªä¸Šç•Œï¼Œéœ€è¦ä¸€ä¸ªå•ç‹¬çš„ where-å­å¥ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">copyWhenGreater</span><span class="hljs-params">(list: <span class="hljs-type">List</span>&lt;<span class="hljs-type">T</span>&gt;, threshold: <span class="hljs-type">T</span>)</span></span>: List&lt;String&gt;<br>    <span class="hljs-keyword">where</span> T : CharSequence,<br>          T : Comparable&lt;T&gt; &#123;<br>    <span class="hljs-keyword">return</span> list.filter &#123; it &gt; threshold &#125;.map &#123; it.toString() &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>æ‰€ä¼ é€’çš„ç±»å‹å¿…é¡»åŒæ—¶æ»¡è¶³<code>where</code>å­å¥çš„æ‰€æœ‰æ¡ä»¶ã€‚åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œç±»å‹<code>T</code>å¿…é¡»<strong>æ—¢å®ç°äº† CharSequence ä¹Ÿå®ç°äº† Comparable</strong>ã€‚<br>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œwhere å­å¥åé¢çš„ç¬¬ä¸€ä¸ªç±»å‹å¯ä»¥æ˜¯æ¥å£ä¹Ÿå¯ä»¥æ˜¯æŠ½è±¡ç±»ã€å®ç°ç±»ï¼Œåç»­çš„ç±»å‹åªèƒ½æ˜¯æ¥å£ã€‚åœ¨ Java ä¸­ä¹Ÿä¸€æ ·</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">MyInterface</span> &#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span>;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyAbstractClass</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-keyword">public</span> &lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">MyInterface</span> &amp; MyAbstractClass&gt; <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">(T t)</span>&#123; <span class="hljs-comment">//errpr</span><br>    t.test();<br>&#125;<br><span class="hljs-keyword">public</span> &lt;T <span class="hljs-keyword">extends</span>  <span class="hljs-title class_">MyAbstractClass</span> &amp; MyInterface &gt; <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">(T t)</span>&#123;<br>    t.test();<br>&#125;<br>    <br></code></pre></td></tr></table></figure>
<p>åŸå› å°±æ˜¯ java ä¸­ä¸å¯ä»¥å¤šç»§æ‰¿ä½†å¯ä»¥å¤šå®ç°</p>
<h4 id="UnsafeVariance"><a href="#UnsafeVariance" class="headerlink" title="@UnsafeVariance"></a>@UnsafeVariance</h4><p>å·®ç‚¹å¿˜äº†è¿™ä¸œè¥¿ï¼Œè¿™ä¸ªæ³¨è§£å°±æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨æˆ‘çŸ¥é“æˆ‘åœ¨åšä»€ä¹ˆï¼Œå¹¶ä¸”ä¿è¯ä¸ä¼šå‡ºé—®é¢˜ï¼Œå¿½ç•¥åå˜å’Œé€†å˜çš„çº¦æŸå°±å¥½äº†<br>æ¯”å¦‚ kotlin ä¸­çš„<code>Collection</code>è¿™ä¸ªç±»ä¸­çš„<code>contains</code>ã€<code>containsAll</code>æ–¹æ³•</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Collection</span>&lt;<span class="hljs-type">out E</span>&gt; : <span class="hljs-type">Iterable</span>&lt;<span class="hljs-type">E</span>&gt; </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">operator</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">contains</span><span class="hljs-params">(element: @<span class="hljs-type">UnsafeVariance</span> <span class="hljs-type">E</span>)</span></span>: <span class="hljs-built_in">Boolean</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">containsAll</span><span class="hljs-params">(elements: <span class="hljs-type">Collection</span>&lt;@<span class="hljs-type">UnsafeVariance</span> <span class="hljs-type">E</span>&gt;)</span></span>: <span class="hljs-built_in">Boolean</span><br>&#125;<br></code></pre></td></tr></table></figure>
<blockquote>
<p>å¯¹äºåå˜çš„ç±»å‹ï¼Œé€šå¸¸æˆ‘ä»¬æ˜¯ä¸å…è®¸å°†æ³›å‹ç±»å‹ä½œä¸ºä¼ å…¥å‚æ•°çš„ç±»å‹çš„ï¼Œæˆ–è€…è¯´ï¼Œå¯¹äºåå˜ç±»å‹ï¼Œæˆ‘ä»¬é€šå¸¸æ˜¯ä¸å…è®¸å…¶æ¶‰åŠæ³›å‹å‚æ•°çš„éƒ¨åˆ†è¢«æ”¹å˜çš„ã€‚<br>è¿™ä¹Ÿå¾ˆå®¹æ˜“è§£&gt;é‡Šä¸ºä»€ä¹ˆ MutableCollection æ˜¯ä¸å˜çš„ï¼Œè€Œ Collection æ˜¯åå˜çš„ï¼Œå› ä¸ºåœ¨ Kotlin å½“ä¸­ï¼Œå‰è€…æ˜¯å¯è¢«ä¿®æ”¹çš„ï¼Œåè€…æ˜¯ä¸å¯è¢«ä¿®æ”¹çš„ã€‚<br>é€†å˜çš„æƒ…å½¢æ­£å¥½ç›¸åï¼Œå³ä¸å¯ä»¥å°†æ³›å‹å‚æ•°ä½œä¸ºæ–¹æ³•çš„è¿”å›å€¼ã€‚</p>
</blockquote>
<p>æ¯”å¦‚è¿™ç§æƒ…å½¢ï¼Œä¸ºäº†è®©ç¼–è¯‘å™¨æ”¾è¿‡ä¸€é©¬ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨ @UnsafeVariance æ¥å‘Šè¯‰ç¼–è¯‘å™¨ï¼šâ€œæˆ‘çŸ¥é“æˆ‘åœ¨å¹²å•¥ï¼Œä¿è¯ä¸ä¼šå‡ºé”™ï¼Œä½ ä¸ç”¨æ‹…å¿ƒâ€ã€‚<br><strong>ä»¥ä¸Šä¿¡æ¯æ¥è‡ª<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/143380842">æ·±å…¥è§£æKotlin æ³›å‹</a></strong></p>
<h4 id="reified-å…³é”®å­—"><a href="#reified-å…³é”®å­—" class="headerlink" title="reified å…³é”®å­—"></a>reified å…³é”®å­—</h4><p>ç”±äºå­˜åœ¨ç±»å‹æ“¦é™¤ï¼Œå¯¼è‡´æˆ‘ä»¬æ— æ³•åœ¨è¿è¡Œæ—¶è·å–æ³›å‹çš„å…·ä½“ç±»å‹ï¼Œæœ‰äº›æ“ä½œæ— æ³•å®ç°ï¼Œæ¯”å¦‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-keyword">void</span> <span class="hljs-title function_">testOne</span><span class="hljs-params">(Object param)</span>&#123;<br>    <span class="hljs-keyword">if</span>(param <span class="hljs-keyword">instanceof</span> T)&#123;<br>        System.out.println(<span class="hljs-string">&quot;T&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>å½“ç„¶ï¼Œåœ¨ kotlin ä¸­ä¹Ÿä¸è¡Œã€‚<br>ä½†åœ¨ java ä¸­æˆ‘ä»¬é€šå¸¸ä¼šä¼ å…¥ä¸€ä¸ª<code>Class&lt;T&gt;</code>æ¥åšç›¸åº”çš„æ“ä½œï¼Œåœ¨ kotlin ä¸­åŒæ ·ä¹Ÿå¯ä»¥ï¼Œä¸è¿‡ kotlin ä¸­æœ‰ä¸€ä¸ªæ›´ç®€å•çš„æ–¹æ³•:ä½¿ç”¨<code>reified</code>é…åˆ<code>inline</code>æ¥å®ç°</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;<span class="hljs-keyword">reified</span> T&gt;</span> <span class="hljs-title">printIfTypeMatch</span><span class="hljs-params">(item: <span class="hljs-type">Any</span>)</span></span> &#123;<br>    <span class="hljs-keyword">if</span> (item <span class="hljs-keyword">is</span> T) &#123; <span class="hljs-comment">// ğŸ‘ˆ è¿™é‡Œå°±ä¸ä¼šåœ¨æç¤ºé”™è¯¯äº†</span><br>        println(item)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>æˆ‘ä»¬ç»å¸¸ç”¨çš„ gsonè§£ææ•°æ®ã€ååºåˆ—åŒ–çš„æ—¶å€™ç»å¸¸é‡åˆ°</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">public</span> &lt;T&gt; T <span class="hljs-title function_">fromJson</span><span class="hljs-params">(String json, Class&lt;T&gt; classOfT)</span> <span class="hljs-keyword">throws</span> JsonSyntaxException &#123; <br>    <br>&#125; <br></code></pre></td></tr></table></figure>
<p>è¿™é‡Œå°±æ˜¯é€šè¿‡å¤šä¼ å…¥ä¸€ä¸ª<code>Class&lt;T&gt;</code>æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåœ¨ kotlin ä¸­æˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰©å±•æ¥å˜åŒ–ä¸€ä¸‹</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;<span class="hljs-keyword">reified</span> T&gt;</span> Gson.<span class="hljs-title">fromJson</span><span class="hljs-params">(json: <span class="hljs-type">String</span>)</span></span>: T&#123; <br>     <span class="hljs-keyword">return</span> fromJson(json, T::<span class="hljs-keyword">class</span>.java) <br> &#125; <br></code></pre></td></tr></table></figure>
<p>æˆ‘ä»¬ç»™ Gson æ·»åŠ äº†ä¸€ä¸ªæ‰©å±•æ–¹æ³•ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œé€šè¿‡<code>inline</code>å’Œ<code>reified</code>å…³é”®å­—å°†æ³›å‹<code>T</code>å˜æˆäº†ä¸€ä¸ªçœŸå®å¯ç”¨çš„ç±»å‹ï¼Œè¿™ä¸¤ä¸ªå…³é”®å­—ç¼ºä¸€ä¸å¯ã€‚è¿™é‡Œå°±ç®€å•çš„è®¤ä¸ºå†…è”æ–¹æ³•(inline)æ˜¯å°†æ–¹æ³•åœ¨ç¼–è¯‘æ—¶å¤åˆ¶åˆ°è°ƒç”¨å¤„ï¼Œä½¿å¾—æ³›å‹ T çš„ç±»å‹åœ¨ç¼–è¯‘æ—¶å°±å¯ä»¥ç¡®å®šã€‚å½“ç„¶è¿™ä¹ˆç†è§£ä¸æ˜¯ç‰¹åˆ«æ­£ç¡®ã€‚åé¢å­¦åˆ°<code>inline</code>ã€<code>noinline</code>ã€<code>crossinline</code>è¿™å‡ ä¸ªå…³é”®å­—çš„æ—¶å€™å†è¯´å§</p>
<p>å‚è€ƒï¼š</p>
<p><a target="_blank" rel="noopener" href="https://book.kotlincn.net/text/generics.html">æ³›å‹ï¼šinã€outã€where</a><br><a target="_blank" rel="noopener" href="https://kotlinlang.org/docs/generics.html">Generics: in, out, where</a><br><a target="_blank" rel="noopener" href="https://ethanhua.github.io/2018/01/09/genericity/">æ·±å…¥ç†è§£Javaå’ŒKotlinä¸­çš„æ³›å‹</a><br><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/143380842">æ·±å…¥è§£æKotlin æ³›å‹</a></p>
<hr>
<p>å·²å­¦ä¹ ï¼š</p>
<ul>
<li><p>æ‰©å±•</p>
<ul>
<li><input type='checkbox' disabled='true' checked>æ‰©å±•å‡½æ•°</input></li>
<li><input type='checkbox' disabled='true' checked>æ‰©å±•å±æ€§</input></li>
<li><input type='checkbox' disabled='true' checked>ä½œç”¨åŸŸ</input></li>
</ul>
</li>
<li><p>å‡½æ•°ç±»å‹</p>
<ul>
<li><input type='checkbox' disabled='true' checked>å¸¦æœ‰æ¥æ”¶è€…çš„å‡½æ•°ç±»å‹</input></li>
<li><input type='checkbox' disabled='true' checked>Lambdaè¡¨è¾¾å¼</input></li>
<li><input type='checkbox' disabled='true' checked>SAM è½¬æ¢</input></li>
</ul>
</li>
<li><p>æ³›å‹</p>
<ul>
<li><input type='checkbox' disabled='true' checked>é€†å˜</input></li>
<li><input type='checkbox' disabled='true' checked>åå˜</input></li>
<li><input type='checkbox' disabled='true' checked>ç±»å‹æŠ•å½±</input></li>
<li><input type='checkbox' disabled='true' checked>æ˜ŸæŠ•å½±</input></li>
<li><input type='checkbox' disabled='true' checked>æ³›å‹çº¦æŸ</input></li>
</ul>
</li>
<li><p>å…³é”®å­—</p>
<ul>
<li><input type='checkbox' disabled='true' checked>ä½œç”¨åŸŸå‡½æ•°ï¼šwithã€letã€runã€applyã€also</input></li>
</ul>
</li>
</ul>
<p>æœªå­¦ä¹ ï¼š</p>
<ul>
<li><p>å…³é”®å­—</p>
<ul>
<li>object</li>
<li>Unit</li>
<li>Nothing</li>
<li>inline,noinline,crossinline</li>
</ul>
</li>
<li><p>å§”æ‰˜</p>
<ul>
<li>å§”æ‰˜ç±»</li>
<li>å§”æ‰˜å±æ€§</li>
<li>è‡ªå®šä¹‰å§”æ‰˜</li>
</ul>
</li>
<li><p>åç¨‹</p>
<ul>
<li>å¯åŠ¨</li>
<li>æŒ‚èµ·</li>
<li>Job</li>
<li>Context</li>
<li>Channel</li>
<li>Flow</li>
<li>select</li>
<li>å¹¶å‘ã€å¼‚å¸¸</li>
<li>launch</li>
<li>Dispatchers</li>
<li>CoroutineScope</li>
</ul>
</li>
</ul>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Android/" class="print-no-link">#Android</a>
      
        <a href="/tags/Kotlin/" class="print-no-link">#Kotlin</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>kotlinæ³›å‹:é€†å˜ä¸åå˜</div>
      <div>https://blog.huangyuanlove.com/2024/04/30/kotlinæ³›å‹-é€†å˜ä¸åå˜/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>HuangYuan_xuan</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2024å¹´4æœˆ30æ—¥</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>è®¸å¯åè®®</div>
          <div>
            
              BY HUANGå…„
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/05/27/kotlin%E5%A7%94%E6%89%98/" title="kotlinå§”æ‰˜">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">kotlinå§”æ‰˜</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/04/28/kotlin%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%87%BD%E6%95%B0-run%E3%80%81let%E3%80%81also%E3%80%81apply%E3%80%81with/" title="kotlinä½œç”¨åŸŸå‡½æ•°:runã€letã€alsoã€applyã€with">
                        <span class="hidden-mobile">kotlinä½œç”¨åŸŸå‡½æ•°:runã€letã€alsoã€applyã€with</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="gitalk-container"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#gitalk-container', function() {
      Fluid.utils.createCssLink('/css/gitalk.css')
      Fluid.utils.createScript('https://lib.baomitu.com/gitalk/1.7.2/gitalk.min.js', function() {
        var options = Object.assign(
          {"clientID":"76c9d0ecf028751aa0d2","clientSecret":"392bc0405dfbdf4928343edef0ef46007f02c7e4","repo":"huangyuanlove.github.io","owner":"huangyuanlove","admin":["huangyuanlove"],"language":"zh-CN","labels":["Gitalk"],"perPage":10,"pagerDirection":"last","distractionFreeMode":false,"createIssueManually":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token"},
          {
            id: '3f58ef9909a1d9b2f4f237016da84ce9'
          }
        )
        var gitalk = new Gitalk(options);
        gitalk.render('gitalk-container');
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>ç›®å½•</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  



  <script>
  Fluid.utils.createScript('https://lib.baomitu.com/mermaid/8.14.0/mermaid.min.js', function() {
    mermaid.initialize({"theme":"default"});

    Fluid.utils.listenDOMLoaded(function() {
      Fluid.events.registerRefreshCallback(function() {
        if ('mermaid' in window) {
          mermaid.init();
        }
      });
    });
  });
</script>






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
